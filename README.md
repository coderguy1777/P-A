All the work for P and A, well some of it, the parts I didn't destroy while too lazy to create new classes to store new code. 
